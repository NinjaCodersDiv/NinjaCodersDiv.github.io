<!DOCTYPE html><html lang="fa" dir="rtl"><head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>مدیریت مقالات</title> <style> /* فونت و متغیرهای رنگ */ :root { --primary-color: #2563eb; --primary-dark: #1d4ed8; --secondary-color: #4b5563; --accent-color: #dc2626; --light-color: #f3f4f6; --dark-color: #111827; --text-color: #374151; --text-light: #6b7280; --border-color: #e5e7eb; --success-color: #16a34a; } /* ریست استایل‌ها */ * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f9fafb; color: var(--text-color); line-height: 1.6; } /* لودر */ .loader-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255, 255, 255, 0.9); display: flex; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.3s ease; } .loader { width: 48px; height: 48px; border: 5px solid var(--border-color); border-bottom-color: var(--primary-color); border-radius: 50%; display: inline-block; animation: rotation 1s linear infinite; } @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } /* هدر */ header { background-color: white; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 100; padding: 1rem 0; } .header-container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; display: flex; justify-content: space-between; align-items: center; } .logo { display: flex; align-items: center; gap: 0.5rem; font-weight: 700; font-size: 1.25rem; color: var(--primary-color); text-decoration: none; } .logo svg { width: 24px; height: 24px; fill: var(--primary-color); } /* منوی ناوبری */ nav ul { display: flex; list-style: none; gap: 1rem; } nav ul li a { text-decoration: none; color: var(--secondary-color); font-weight: 500; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: all 0.2s; } nav ul li a:hover, nav ul li a.active { background-color: var(--primary-color); color: white; } /* بخش اصلی */ .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; } /* پنل مدیریت */ .panel { background-color: white; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); padding: 1.5rem; margin-bottom: 2rem; } .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); } .panel-header h2 { font-size: 1.25rem; font-weight: 600; color: var(--dark-color); } /* دکمه‌ها */ .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 500; cursor: pointer; transition: all 0.2s; border: none; font-size: 0.875rem; } .btn svg { width: 16px; height: 16px; } .btn-primary { background-color: var(--primary-color); color: white; } .btn-primary:hover { background-color: var(--primary-dark); } .btn-danger { background-color: var(--accent-color); color: white; } .btn-danger:hover { opacity: 0.9; } .btn-secondary { background-color: var(--secondary-color); color: white; } .btn-secondary:hover { opacity: 0.9; } /* جدول مقالات */ .table-container { overflow-x: auto; margin-top: 1.5rem; } table { width: 100%; border-collapse: collapse; font-size: 0.875rem; } th, td { padding: 0.75rem 1rem; text-align: right; border-bottom: 1px solid var(--border-color); } th { background-color: var(--light-color); font-weight: 600; color: var(--dark-color); } tr:hover { background-color: var(--light-color); } .action-buttons { display: flex; gap: 0.5rem; } .btn-sm { padding: 0.25rem 0.5rem; font-size: 0.75rem; } /* فرم مقاله */ #article-form { margin-top: 1.5rem; } .form-group { margin-bottom: 1rem; } .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--dark-color); } .form-control { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid var(--border-color); border-radius: 0.375rem; font-size: 0.875rem; transition: border-color 0.2s; } .form-control:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1); } textarea.form-control { min-height: 150px; resize: vertical; } /* پیش‌نمایش تصاویر */ .image-preview { max-width: 200px; max-height: 200px; margin-top: 0.5rem; border-radius: 0.375rem; border: 1px solid var(--border-color); display: none; } /* پیام‌ها */ .alert { padding: 1rem; border-radius: 0.375rem; margin-bottom: 1rem; } .alert-success { background-color: #dcfce7; color: var(--success-color); border: 1px solid #bbf7d0; } .alert-error { background-color: #fee2e2; color: #991b1b; border: 1px solid #fecaca; } /* حالت‌های مخفی */ .hidden { display: none; } /* ریسپانسیو */ @media (max-width: 768px) { .header-container { flex-direction: column; gap: 1rem; } nav ul { width: 100%; justify-content: center; } .panel-header { flex-direction: column; align-items: flex-start; gap: 1rem; } .action-buttons { flex-direction: column; } .btn { width: 100%; } } </style></head><body> <!-- Loader --> <div class="loader-container hidden" id="loader"> <div class="loader"></div> </div> <!-- هدر --> <header> <div class="header-container"> <a href="#" class="logo" id="home-link"> <svg viewBox="0 0 24 24"> <path d="M13 3H11V13H13V3ZM17.83 5.17L16.41 6.59C17.99 7.86 19 9.81 19 12C19 15.87 15.87 19 12 19C8.13 19 5 15.87 5 12C5 9.81 6.01 7.86 7.58 6.58L6.17 5.17C4.23 6.82 3 9.26 3 12C3 16.97 7.03 21 12 21C16.97 21 21 16.97 21 12C21 9.26 19.77 6.82 17.83 5.17Z"/> </svg> مدیریت مقالات </a> <nav> <ul> <li><a href="#" id="view-articles-link" class="active">مقالات</a></li> <li><a href="#" id="add-article-link">مقاله جدید</a></li> </ul> </nav> </div> </header> <!-- بخش اصلی محتوا --> <div class="container"> <!-- لیست مقالات --> <div id="articles-list"> <div class="panel"> <div class="panel-header"> <h2>مقالات</h2> <button class="btn btn-primary" id="add-new-article"> <svg viewBox="0 0 24 24" fill="currentColor"> <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/> </svg> مقاله جدید </button> </div> <div class="table-container"> <div id="loading-articles" class="loading hidden">در حال بارگذاری مقالات...</div> <table id="articles-table"> <thead> <tr> <th>تصویر</th> <th>عنوان</th> <th>دسته‌بندی</th> <th>تاریخ</th> <th>عملیات</th> </tr> </thead> <tbody id="articles-table-body"></tbody> </table> </div> </div> </div> <!-- فرم مقاله --> <div id="article-form-container" class="hidden"> <div class="panel"> <div class="panel-header"> <h2 id="form-title">مقاله جدید</h2> <button class="btn btn-secondary" id="back-to-list"> <svg viewBox="0 0 24 24" fill="currentColor"> <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/> </svg> بازگشت به لیست </button> </div> <form id="article-form"> <input type="hidden" id="article-id"> <div class="form-group"> <label for="title">عنوان مقاله</label> <input type="text" class="form-control" id="title" required> </div> <div class="form-group"> <label for="category">دسته‌بندی</label> <input type="text" class="form-control" id="category" required> </div> <div class="form-group"> <label for="excerpt">خلاصه مقاله</label> <textarea class="form-control" id="excerpt" required></textarea> </div> <div class="form-group"> <label for="content">محتوا</label> <textarea class="form-control" id="content" required></textarea> </div> <div class="form-group"> <label for="author">نویسنده</label> <input type="text" class="form-control" id="author" required> </div> <div class="form-group"> <label for="image_url">لینک تصویر مقاله</label> <input type="url" class="form-control" id="image_url" placeholder="https://example.com/image.jpg"> <img id="image-preview" class="image-preview"> </div> <div class="form-group"> <label for="author_image_url">لینک تصویر نویسنده</label> <input type="url" class="form-control" id="author_image_url" placeholder="https://example.com/author.jpg"> <img id="author-image-preview" class="image-preview"> </div> <div class="form-group"> <button type="submit" class="btn btn-primary"> <svg viewBox="0 0 24 24" fill="currentColor"> <path d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/> </svg> ذخیره مقاله </button> <button type="button" class="btn btn-danger" id="delete-article" style="display: none;"> <svg viewBox="0 0 24 24" fill="currentColor"> <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/> </svg> حذف مقاله </button> </div> </form> </div> </div> </div> <script> const API_BASE_URL = 'https://ninja-api-w1ch.onrender.com'; const elements = { loader: document.getElementById('loader'), articlesList: document.getElementById('articles-list'), articleFormContainer: document.getElementById('article-form-container'), articlesTableBody: document.getElementById('articles-table-body'), loadingArticles: document.getElementById('loading-articles'), articlesTable: document.getElementById('articles-table'), articleForm: document.getElementById('article-form'), formTitle: document.getElementById('form-title'), deleteBtn: document.getElementById('delete-article') }; /** * نمایش Loader */ function showLoader(show) { if (show) { elements.loader.classList.remove('hidden'); } else { elements.loader.classList.add('hidden'); } } /** * دریافت لیست مقالات از API */ async function fetchArticles() { try { showLoader(true); elements.loadingArticles.classList.remove('hidden'); elements.articlesTable.classList.add('hidden'); const response = await fetch(`${API_BASE_URL}/articles/`); if (!response.ok) { throw new Error('خطا در دریافت مقالات'); } const articles = await response.json(); renderArticles(articles); } catch (error) { showAlert(error.message, 'error'); } finally { showLoader(false); elements.loadingArticles.classList.add('hidden'); elements.articlesTable.classList.remove('hidden'); } } /** * نمایش مقالات در جدول */ function renderArticles(articles) { elements.articlesTableBody.innerHTML = ''; if (articles.length === 0) { elements.articlesTableBody.innerHTML = ` <tr> <td colspan="5" style="text-align: center;">مقاله‌ای یافت نشد</td> </tr> `; return; } articles.forEach(article => { const tr = document.createElement('tr'); tr.innerHTML = ` <td> <img src="${article.image_url || 'https://via.placeholder.com/80x50?text=بدون+تصویر'}" width="80" height="50" style="object-fit: cover; border-radius: 4px;" onerror="this.src='https://via.placeholder.com/80x50?text=خطا+در+تصویر'" loading="lazy"> </td> <td>${article.title}</td> <td>${article.category}</td> <td>${article.date}</td> <td class="action-buttons"> <button class="btn btn-primary btn-sm edit-btn" data-id="${article.id}"> <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"> <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/> </svg> ویرایش </button> <button class="btn btn-danger btn-sm delete-btn" data-id="${article.id}"> <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"> <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/> </svg> حذف </button> </td> `; elements.articlesTableBody.appendChild(tr); }); document.querySelectorAll('.edit-btn').forEach(btn => { btn.addEventListener('click', () => editArticle(btn.dataset.id)); }); document.querySelectorAll('.delete-btn').forEach(btn => { btn.addEventListener('click', () => confirmDeleteArticle(btn.dataset.id)); }); } /** * نمایش فرم ویرایش مقاله */ async function editArticle(id) { try { showLoader(true); const response = await fetch(`${API_BASE_URL}/articles/${id}`); if (!response.ok) { throw new Error('خطا در دریافت مقاله'); } const article = await response.json(); showArticleForm(article); } catch (error) { showAlert(error.message, 'error'); } finally { showLoader(false); } } /** * نمایش فرم مقاله (جدید یا ویرایش) */ function showArticleForm(article = null) { elements.articleForm.reset(); if (article) { document.getElementById('article-id').value = article.id; document.getElementById('title').value = article.title; document.getElementById('category').value = article.category; document.getElementById('excerpt').value = article.excerpt; document.getElementById('content').value = article.content; document.getElementById('author').value = article.author; document.getElementById('image_url').value = article.image_url || ''; document.getElementById('author_image_url').value = article.author_image_url || ''; const imagePreview = document.getElementById('image-preview'); if (article.image_url) { imagePreview.src = article.image_url; imagePreview.style.display = 'block'; } const authorImagePreview = document.getElementById('author-image-preview'); if (article.author_image_url) { authorImagePreview.src = article.author_image_url; authorImagePreview.style.display = 'block'; } elements.formTitle.textContent = 'ویرایش مقاله'; elements.deleteBtn.style.display = 'inline-flex'; } else { elements.formTitle.textContent = 'مقاله جدید'; elements.deleteBtn.style.display = 'none'; document.getElementById('image-preview').style.display = 'none'; document.getElementById('author-image-preview').style.display = 'none'; } elements.articlesList.classList.add('hidden'); elements.articleFormContainer.classList.remove('hidden'); document.getElementById('view-articles-link').classList.remove('active'); document.getElementById('add-article-link').classList.add('active'); } /** * ذخیره مقاله (ایجاد یا ویرایش) */ async function saveArticle(e) { e.preventDefault(); const id = document.getElementById('article-id').value; const articleData = { title: document.getElementById('title').value, category: document.getElementById('category').value, excerpt: document.getElementById('excerpt').value, content: document.getElementById('content').value, author: document.getElementById('author').value, image_url: document.getElementById('image_url').value || '', author_image_url: document.getElementById('author_image_url').value || '' }; try { showLoader(true); const url = id ? `${API_BASE_URL}/articles/${id}` : `${API_BASE_URL}/articles/`; const method = id ? 'PUT' : 'POST'; const response = await fetch(url, { method, headers: { 'Content-Type': 'application/x-www-form-urlencoded', }, body: new URLSearchParams(articleData) }); if (!response.ok) { const errorData = await response.json(); throw new Error(errorData.detail || 'خطا در ذخیره مقاله'); } const result = await response.json(); showAlert(`مقاله با موفقیت ${id ? 'ویرایش' : 'ذخیره'} شد`, 'success'); showArticlesList(); fetchArticles(); } catch (error) { showAlert(error.message, 'error'); } finally { showLoader(false); } } /** * حذف مقاله */ async function deleteArticle(id) { try { showLoader(true); const response = await fetch(`${API_BASE_URL}/articles/${id}`, { method: 'DELETE' }); if (!response.ok) { throw new Error('خطا در حذف مقاله'); } showAlert('مقاله با موفقیت حذف شد', 'success'); fetchArticles(); } catch (error) { showAlert(error.message, 'error'); } finally { showLoader(false); } } /** * تایید قبل از حذف مقاله */ function confirmDeleteArticle(id) { if (confirm('آیا از حذف این مقاله مطمئن هستید؟')) { deleteArticle(id); } } /** * نمایش لیست مقالات */ function showArticlesList() { elements.articleFormContainer.classList.add('hidden'); elements.articlesList.classList.remove('hidden'); document.getElementById('view-articles-link').classList.add('active'); document.getElementById('add-article-link').classList.remove('active'); } /** * نمایش پیام به کاربر */ function showAlert(message, type = 'success') { const alert = document.createElement('div'); alert.className = `alert alert-${type}`; alert.textContent = message; const container = document.querySelector('.container'); container.prepend(alert); setTimeout(() => { alert.remove(); }, 5000); } /** * راه‌اندازی اولیه */ document.addEventListener('DOMContentLoaded', () => { document.getElementById('add-new-article').addEventListener('click', () => showArticleForm()); document.getElementById('back-to-list').addEventListener('click', showArticlesList); document.getElementById('view-articles-link').addEventListener('click', (e) => { e.preventDefault(); showArticlesList(); }); document.getElementById('add-article-link').addEventListener('click', (e) => { e.preventDefault(); showArticleForm(); }); document.getElementById('home-link').addEventListener('click', (e) => { e.preventDefault(); showArticlesList(); }); elements.articleForm.addEventListener('submit', saveArticle); elements.deleteBtn.addEventListener('click', () => { const id = document.getElementById('article-id').value; if (id) confirmDeleteArticle(id); }); document.getElementById('image_url').addEventListener('input', (e) => { const img = document.getElementById('image-preview'); img.src = e.target.value; img.style.display = e.target.value ? 'block' : 'none'; img.onerror = function() { this.src = 'https://via.placeholder.com/200x200?text=Image+Not+Found'; }; }); document.getElementById('author_image_url').addEventListener('input', (e) => { const img = document.getElementById('author-image-preview'); img.src = e.target.value; img.style.display = e.target.value ? 'block' : 'none'; img.onerror = function() { this.src = 'https://via.placeholder.com/200x200?text=Author+Image+Not+Found'; }; }); fetchArticles(); }); </script></body></html>
